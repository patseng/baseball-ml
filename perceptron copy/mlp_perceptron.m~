% training
trainMatrix = csvread('train_matrix.out');
D = trainMatrix(:,1)';
trainMatrix(:,1) = []; % remove labels from training set
X = trainMatrix';
X = X(1:14,:);
p = size(X, 1);
H = floor((p+1)/2)+10;
m = 1;

mu = .75;
alpha = .001;
epoch = 5000;
MSEmin = 1e-20;

[Wx,Wy,MSE]=trainMLP(p,H,m,mu,alpha,X,D,epoch,MSEmin);

semilogy(MSE);

disp(['D = [' num2str(D) ']']);


% testing
testMatrix = csvread('test_matrix.out');
X

Y = runMLP(X,Wx,Wy);

disp(['Y = [' num2str(Y) ']']);





numWrongAnswers = 0;

for i=1:size(D,2)
    if Y(i) >= 0.5
        guess = 1;
    else
        guess = 0;
    end
    if D(i) ~= guess;
        numWrongAnswers = numWrongAnswers+1;
    end
end

numWrongAnswers/size(D,2)